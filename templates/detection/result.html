{% extends 'base.html' %}

{% block content %}
<link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;600;900&display=swap" rel="stylesheet">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/all.min.css">
<style>
    body {
        font-family: "Poppins", sans-serif;
        background: linear-gradient(135deg, #48cae4 0%, #0077b6 60%, #023e8a 100%);
        min-height: 100vh;
        padding-top: 50px;
        overflow-x: hidden;
    }
    .animated-bg {
        position: fixed;
        top: 0; left: 0; width: 100vw; height: 100vh;
        z-index: -1;
        background: url('https://www.transparenttextures.com/patterns/cubes.png'), linear-gradient(135deg, #48cae4 0%, #0077b6 60%, #023e8a 100%);
        opacity: 0.18;
        animation: bgMove 18s linear infinite alternate;
    }
    @keyframes bgMove {
        0% { background-position: 0 0, 0 0; }
        100% { background-position: 100px 100px, 0 0; }
    }
    .glass-card {
        background: rgba(255, 255, 255, 0.18);
        backdrop-filter: blur(18px);
        border-radius: 28px;
        padding: 38px 32px 32px 32px;
        box-shadow: 0 0 40px 10px rgba(0, 255, 255, 0.18), 0 0 0 1.5px #00eaff;
        border: 1.5px solid rgba(255, 255, 255, 0.35);
        animation: fadeIn 1.1s cubic-bezier(.4,0,.2,1);
    }
    @keyframes fadeIn {
        from { opacity: 0; transform: translateY(25px); }
        to { opacity: 1; transform: translateY(0); }
    }
    .title {
        text-align: center;
        color: #fff;
        text-transform: uppercase;
        font-weight: 900;
        font-size: 2.2rem;
        margin-bottom: 28px;
        letter-spacing: 2.5px;
        text-shadow: 0 2px 16px #00eaff, 0 1px 0 #fff;
        display: flex;
        align-items: center;
        justify-content: center;
        gap: 16px;
    }
    .title i {
        font-size: 2.3rem;
        color: #00eaff;
        filter: drop-shadow(0 0 8px #00eaff99);
    }
    .image-box {
        position: relative;
        display: inline-block;
        animation: zoomIn 0.8s cubic-bezier(.4,0,.2,1);
    }
    @keyframes zoomIn {
        from { transform: scale(0.92); opacity: 0; }
        to { transform: scale(1); opacity: 1; }
    }
    .image-box img {
        max-width: 420px;
        border-radius: 18px;
        border: 3.5px solid #00eaff;
        box-shadow: 0 0 32px 0 rgba(0, 238, 255, 0.25), 0 0 0 2px #fff;
        transition: box-shadow 0.3s;
    }
    .image-box img:hover {
        box-shadow: 0 0 60px 0 #00eaff, 0 0 0 2.5px #fff;
    }
    .bbox {
        stroke: #ff0033;
        stroke-width: 4;
        stroke-linejoin: round;
        fill: none;
        filter: drop-shadow(0 0 8px #ff0033cc);
        animation: pulse 1.4s infinite cubic-bezier(.4,0,.2,1);
        transition: stroke 0.2s;
    }
    .bbox:hover {
        stroke: #00eaff;
        filter: drop-shadow(0 0 16px #00eaffcc);
    }
    @keyframes pulse {
        0% { stroke-width: 4; opacity: 1; }
        50% { stroke-width: 7; opacity: 0.7; }
        100% { stroke-width: 4; opacity: 1; }
    }
    .prediction-box {
        background: rgba(255, 255, 255, 0.55);
        border-left: 7px solid #00eaff;
        border-radius: 14px;
        padding: 22px 18px 18px 18px;
        font-size: 1.25rem;
        margin-top: 18px;
        box-shadow: 0 0 18px 0 rgba(0, 238, 255, 0.13);
        animation: fadeIn 1.2s 0.2s backwards;
        display: flex;
        flex-direction: column;
        align-items: center;
    }
    .badge-pred {
        display: inline-block;
        padding: 7px 18px;
        border-radius: 18px;
        font-weight: 700;
        font-size: 1.15em;
        color: #fff;
        background: linear-gradient(90deg, #00eaff 60%, #0096c7 100%);
        box-shadow: 0 0 12px #00eaff99;
        letter-spacing: 1.5px;
        margin-left: 10px;
        text-shadow: 0 1px 6px #0096c7;
        border: none;
        animation: popIn 0.7s cubic-bezier(.4,0,.2,1);
    }
    .badge-pred.vide {
        background: linear-gradient(90deg, #ffb703 60%, #fb8500 100%);
        box-shadow: 0 0 12px #fb850099;
        text-shadow: 0 1px 6px #fb8500;
    }
    @keyframes popIn {
        from { transform: scale(0.7); opacity: 0; }
        to { transform: scale(1); opacity: 1; }
    }
    .score-anim {
        display: inline-block;
        margin-left: 10px;
        font-size: 1.05em;
        color: #023e8a;
        font-weight: 600;
        background: #e0fbfc;
        border-radius: 10px;
        padding: 4px 12px;
        box-shadow: 0 0 8px #00eaff33;
        animation: popIn 0.8s 0.2s backwards;
    }
    .result-icon {
        font-size: 2.5rem;
        margin-right: 12px;
        vertical-align: middle;
        filter: drop-shadow(0 0 8px #00eaff99);
    }
    .result-icon.vide {
        color: #fb8500;
        filter: drop-shadow(0 0 8px #fb850099);
    }
    .btn-modern {
        padding: 14px 24px;
        font-size: 1.15rem;
        border-radius: 14px;
        font-weight: 700;
        transition: 0.3s;
        margin-top: 10px;
    }
    .btn-modern:hover {
        transform: translateY(-3px) scale(1.04);
        box-shadow: 0 8px 28px rgba(0, 238, 255, 0.4);
    }
    .neon-btn {
        background: linear-gradient(135deg, #00eaff, #0096c7);
        border: none;
        color: white;
        box-shadow: 0 0 16px #00eaffcc;
    }
    .neon-btn:hover {
        box-shadow: 0 0 32px #00eaff;
    }
    .outline-btn {
        border: 2.5px solid white;
        color: white;
        background: transparent;
    }
    .outline-btn:hover {
        background: rgba(255, 255, 255, 0.18);
    }
</style>
<div class="animated-bg"></div>
<div class="container">
    <div class="row justify-content-center">
        <div class="col-md-8">
            <div class="glass-card">
                <div class="title">
                    <i class="fa-solid fa-recycle"></i>
                    Résultat de la prédiction
                </div>
                <div class="text-center">
                    <div class="image-box">
                        <img src="{{ img.image.url }}" id="poubelle-img">
                        {% if img.box_x and img.box_y and img.box_w and img.box_h %}
                        <svg width="420" height="420" style="position:absolute; left:0; top:0; pointer-events:none;">
                            <rect 
                                class="bbox"
                                x="{{ img.box_x }}" 
                                y="{{ img.box_y }}" 
                                width="{{ img.box_w }}" 
                                height="{{ img.box_h }}"
                            />
                        </svg>
                        {% endif %}
                    </div>
                    <div class="prediction-box text-center text-dark mt-4">
                        <strong>État prédit :</strong>
                        {% if img.pred %}
                            {% if img.pred == 'vide' %}
                                <i class="fa-solid fa-trash result-icon vide"></i>
                            {% else %}
                                <i class="fa-solid fa-trash-can result-icon"></i>
                            {% endif %}
                            <span class="badge-pred {% if img.pred == 'vide' %}vide{% endif %}">{{ img.pred }}</span>
                            {% if img.score %}
                                <span class="score-anim">confiance : {{ img.score }}</span>
                            {% endif %}
                        {% else %}
                            <span class="badge-pred">Non détecté</span>
                        {% endif %}
                    </div>
                    <div class="mt-4">
                        <a href="/" class="btn btn-modern neon-btn"><i class="fa-solid fa-arrow-left"></i> Analyser une autre image</a>
                        <a href="/download-model/" class="btn btn-modern outline-btn ms-2"><i class="fa-solid fa-download"></i> Télécharger le modèle</a>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>
{% endblock %}
